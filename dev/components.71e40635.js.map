{"version":3,"sources":["../vendor/components.js"],"names":["root","factory","define","amd","module","exports","HTMLImport","window","IMPORT_SELECTOR","onDOMReady","cb","document","attachEvent","readyState","addEventListener","HtmlImport","html","div","createElement","innerHTML","els","Array","from","querySelectorAll","length","importForElements","then","el","url","getAttribute","repeat","parseInt","processHtmlString","bind","fetch","response","text","parentNode","insertAdjacentHTML","removeChild","imports","importForElement","Promise","all","map","resolve","importer","createCustomEvent","type","detail","CustomEvent","e","ev","createEvent","initCustomEvent","import","urls","event","dispatchEvent","loadJs","script","src","onload","head","appendChild"],"mappings":";;;;;;;;;AAAA,CAAC,UAAUA,IAAV,EAAgBC,OAAhB,EAAyB;AACxB,MAAI,OAAOC,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACC,GAA3C,EAAgD;AAC9C;AACAD,IAAAA,MAAM,CAAC,EAAD,EAAKD,OAAL,CAAN;AACD,GAHD,MAGO,IAAI,QAAOG,MAAP,yCAAOA,MAAP,OAAkB,QAAlB,IAA8BA,MAAM,CAACC,OAAzC,EAAkD;AACvD;AACA;AACA;AACAD,IAAAA,MAAM,CAACC,OAAP,GAAiBJ,OAAO,EAAxB;AACD,GALM,MAKA;AACL;AACAD,IAAAA,IAAI,CAACM,UAAL,GAAkBL,OAAO,EAAzB;AACD;AACF,CAbD,EAaGM,MAbH,EAaW,YAAY;AACrB,MAAMC,eAAe,GAAG,uBAAxB;AAEA;;;;;AAIA,WAASC,UAAT,CAAoBC,EAApB,EAAwB;AACxB;AAGE,QACEC,QAAQ,CAACC,WAAT,GACID,QAAQ,CAACE,UAAT,KAAwB,UAD5B,GAEIF,QAAQ,CAACE,UAAT,KAAwB,SAH9B,EAIE;AACA,aAAOH,EAAE,EAAT;AACD;;AACDC,IAAAA,QAAQ,CAACG,gBAAT,CAA0B,kBAA1B,EAA8CJ,EAA9C;AACD;;AAnBoB,MAqBfK,UArBe;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAsBnB;;;;;AAtBmB,wCA2BDC,IA3BC,EA2BK;AACtB,YAAMC,GAAG,GAAGN,QAAQ,CAACO,aAAT,CAAuB,KAAvB,CAAZ;AACAD,QAAAA,GAAG,CAACE,SAAJ,GAAgBH,IAAhB;AACA,YAAMI,GAAG,GAAGC,KAAK,CAACC,IAAN,CAAWL,GAAG,CAACM,gBAAJ,CAAqBf,eAArB,CAAX,CAAZ;AACA,eAAOY,GAAG,CAACI,MAAJ,GACH,KAAKC,iBAAL,CAAuBL,GAAvB,EAA4BM,IAA5B,CAAiC;AAAA,iBAAMT,GAAG,CAACE,SAAV;AAAA,SAAjC,CADG,GAEHH,IAFJ;AAGD;AAED;;;;;;AAKA;;;AAzCmB;AAAA;AAAA,uCA2CFW,EA3CE,EA2CE;AACnB,YAAMC,GAAG,GAAGD,EAAE,CAACE,YAAH,CAAgB,MAAhB,CAAZ;AAAA,YACEC,MAAM,GAAGC,QAAQ,CAACJ,EAAE,CAACE,YAAH,CAAgB,QAAhB,KAA6B,CAA9B,EAAiC,EAAjC,CADnB;AAAA,YAEEG,iBAAiB,GAAG,KAAKA,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAFtB;AAIA,eAAOC,KAAK,CAACN,GAAD,CAAL,CACJF,IADI,CACC,UAACS,QAAD;AAAA,iBAAcA,QAAQ,CAACC,IAAT,EAAd;AAAA,SADD,EAEJV,IAFI,CAECM,iBAFD,EAGJN,IAHI,CAGC,UAACV,IAAD,EAAU;AACd,cAAI,CAACW,EAAE,CAACU,UAAR,EAAoB;AAClB;AACD;;AACDV,UAAAA,EAAE,CAACW,kBAAH,CAAsB,aAAtB,EAAqCtB,IAAI,CAACc,MAAL,CAAYA,MAAZ,CAArC;AACAH,UAAAA,EAAE,CAACU,UAAH,CAAcE,WAAd,CAA0BZ,EAA1B;AACA,iBAAOC,GAAP;AACD,SAVI,CAAP;AAWD;AAED;;;;;;AA7DmB;AAAA;AAAA,wCAkEDY,OAlEC,EAkEQ;AACzB,YAAMC,gBAAgB,GAAG,KAAKA,gBAAL,CAAsBR,IAAtB,CAA2B,IAA3B,CAAzB;AACA,eAAOS,OAAO,CAACC,GAAR,CAAYH,OAAO,CAACI,GAAR,CAAYH,gBAAZ,CAAZ,CAAP;AACD;AACD;;;;;AAtEmB;AAAA;AAAA,gCA0EV;AACP,YAAMD,OAAO,GAAGnB,KAAK,CAACC,IAAN,CAAWX,QAAQ,CAACY,gBAAT,CAA0Bf,eAA1B,CAAX,CAAhB;;AACA,YAAI,CAACgC,OAAO,CAAChB,MAAb,EAAqB;AACnB,iBAAOkB,OAAO,CAACG,OAAR,EAAP;AACD;;AACD,eAAO,KAAKpB,iBAAL,CAAuBe,OAAvB,CAAP;AACD;AAhFkB;;AAAA;AAAA;;AAmFrB,MAAMM,QAAQ,GAAG,IAAI/B,UAAJ,EAAjB;AACA;;;;;;;AAMA,WAASgC,iBAAT,CAA2BC,IAA3B,EAAiCC,MAAjC,EAAyC;AACvC,QAAI;AACF,aAAO,IAAIC,WAAJ,CAAgBF,IAAhB,EAAsB;AAAEC,QAAAA,MAAM,EAAEA;AAAV,OAAtB,CAAP;AACD,KAFD,CAEE,OAAOE,CAAP,EAAU;AACV,UAAMC,EAAE,GAAGzC,QAAQ,CAAC0C,WAAT,CAAqB,aAArB,CAAX;AACAD,MAAAA,EAAE,CAACE,eAAH,CAAmBN,IAAnB,EAAyB,KAAzB,EAAgC,KAAhC,EAAuC;AAAEC,QAAAA,MAAM,EAAEA;AAAV,OAAvC;AACA,aAAOG,EAAP;AACD;AACF;;AAED3C,EAAAA,UAAU,CAAC,YAAM;AACfqC,IAAAA,QAAQ,CAACS,MAAT,GAAkB7B,IAAlB,CAAuB,UAAC8B,IAAD,EAAU;AAC/B,UAAMC,KAAK,GAAGV,iBAAiB,CAAC,qBAAD,EAAwB;AAAES,QAAAA,IAAI,EAAJA;AAAF,OAAxB,CAA/B;AACA7C,MAAAA,QAAQ,CAAC+C,aAAT,CAAuBD,KAAvB;AACD,KAHD;AAID,GALS,CAAV;AAOA;;;;;;AAKAX,EAAAA,QAAQ,CAACa,MAAT,GAAkB,UAAC/B,GAAD,EAAS;AACzB,WAAO,IAAIc,OAAJ,CAAY,UAACG,OAAD,EAAa;AAC9B,UAAMe,MAAM,GAAGjD,QAAQ,CAACO,aAAT,CAAuB,QAAvB,CAAf;AACA0C,MAAAA,MAAM,CAACC,GAAP,GAAajC,GAAb;AACAgC,MAAAA,MAAM,CAACE,MAAP,GAAgBjB,OAAhB;AACAlC,MAAAA,QAAQ,CAACoD,IAAT,CAAcC,WAAd,CAA0BJ,MAA1B;AACD,KALM,CAAP;AAMD,GAPD;;AASA,SAAOd,QAAP;AACD,CAvID","file":"components.71e40635.js","sourceRoot":"..\\src","sourcesContent":["(function (root, factory) {\r\n  if (typeof define === \"function\" && define.amd) {\r\n    // AMD. Register as an anonymous module.\r\n    define([], factory);\r\n  } else if (typeof module === \"object\" && module.exports) {\r\n    // Node. Does not work with strict CommonJS, but\r\n    // simple async load can fix -sam \r\n    //todo: Node link\r\n    module.exports = factory();\r\n  } else {\r\n    // Browser globals (root is window)\r\n    root.HTMLImport = factory();\r\n  }\r\n})(window, function () {\r\n  const IMPORT_SELECTOR = \"link[rel=html-import]\";\r\n\r\n  /**\r\n   * Invoke a given handler when DOM is ready\r\n   * @param {function} cb\r\n   */\r\n  function onDOMReady(cb) {\r\n  // Polling for the sake of my intern tests\r\n\r\n\r\n    if (\r\n      document.attachEvent\r\n        ? document.readyState === \"complete\"\r\n        : document.readyState !== \"loading\"\r\n    ) {\r\n      return cb();\r\n    }\r\n    document.addEventListener(\"DOMContentLoaded\", cb);\r\n  }\r\n\r\n  class HtmlImport {\r\n    /**\r\n     * Process all th eimports in the newly fetched HTML\r\n     * @param {string} html\r\n     * @returns Promise\r\n     */\r\n    processHtmlString(html) {\r\n      const div = document.createElement(\"div\");\r\n      div.innerHTML = html;\r\n      const els = Array.from(div.querySelectorAll(IMPORT_SELECTOR));\r\n      return els.length\r\n        ? this.importForElements(els).then(() => div.innerHTML)\r\n        : html;\r\n    }\r\n\r\n    /**\r\n     * Process imports in a given Node\r\n     * @param {Node} el\r\n     * @returns {Promise}\r\n     */\r\n    /* todo: Repeat repeat=\"3\">\r\n     */\r\n    importForElement(el) {\r\n      const url = el.getAttribute(\"href\"),\r\n        repeat = parseInt(el.getAttribute(\"repeat\") || 1, 10),\r\n        processHtmlString = this.processHtmlString.bind(this);\r\n\r\n      return fetch(url)\r\n        .then((response) => response.text())\r\n        .then(processHtmlString)\r\n        .then((html) => {\r\n          if (!el.parentNode) {\r\n            return;\r\n          }\r\n          el.insertAdjacentHTML(\"beforebegin\", html.repeat(repeat));\r\n          el.parentNode.removeChild(el);\r\n          return url;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Load all given imports\r\n     * @param {Node[]} imports\r\n     * @returns {Promise}\r\n     */\r\n    importForElements(imports) {\r\n      const importForElement = this.importForElement.bind(this);\r\n      return Promise.all(imports.map(importForElement));\r\n    }\r\n    /**\r\n     * Find and process all the imports in the DOM\r\n     * @returns {Promise}\r\n     */\r\n    import() {\r\n      const imports = Array.from(document.querySelectorAll(IMPORT_SELECTOR));\r\n      if (!imports.length) {\r\n        return Promise.resolve();\r\n      }\r\n      return this.importForElements(imports);\r\n    }\r\n  }\r\n\r\n  const importer = new HtmlImport();\r\n  /**\r\n   * CustomEvent with support for IE (9+)\r\n   * @param {string} type\r\n   * @param {Object} detail\r\n   * @returns {object}\r\n   */\r\n  function createCustomEvent(type, detail) {\r\n    try {\r\n      return new CustomEvent(type, { detail: detail });\r\n    } catch (e) {\r\n      const ev = document.createEvent(\"CustomEvent\");\r\n      ev.initCustomEvent(type, false, false, { detail: detail });\r\n      return ev;\r\n    }\r\n  }\r\n\r\n  onDOMReady(() => {\r\n    importer.import().then((urls) => {\r\n      const event = createCustomEvent(\"html-imports-loaded\", { urls });\r\n      document.dispatchEvent(event);\r\n    });\r\n  });\r\n\r\n  /**\r\n   * Load JavaScript - async import -sam\r\n   * @param {string} url\r\n   * @returns {Promise}\r\n   */\r\n  importer.loadJs = (url) => {\r\n    return new Promise((resolve) => {\r\n      const script = document.createElement(\"script\");\r\n      script.src = url;\r\n      script.onload = resolve;\r\n      document.head.appendChild(script);\r\n    });\r\n  };\r\n\r\n  return importer;\r\n});\r\n"]}